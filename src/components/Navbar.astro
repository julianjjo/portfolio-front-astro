---
import XMarkIcon from "astro-heroicons/solid/XMark.astro";
import Bars3Icon from "astro-heroicons/solid/Bars3.astro";
import { Image } from "astro:assets";
import ProfileImage from "../assets/profile_image.jpeg";

const navigation = [
	{ name: "About", href: "/", current: true },
	{ name: "Experience", href: "/experience", current: false },
	{ name: "Skills", href: "/skills", current: false },
	{ name: "Contact", href: "/contact", current: false },
];

const currentPath = Astro.url.pathname;
---

<header
	class="fixed top-6 left-0 right-0 z-50 flex justify-center px-4 pointer-events-none"
>
	<nav
		class="pointer-events-auto glass-nav rounded-2xl px-3 py-2 flex items-center gap-4 border border-white/10 shadow-2xl transition-all duration-300 hover:border-white/20"
	>
		<div class="flex items-center gap-2 pr-2 border-r border-white/10">
			<Image
				src={ProfileImage}
				alt="self portrait"
				class="h-8 w-8 rounded-full border border-white/20 object-cover shadow-sm"
			/>
			<span
				class="text-xs font-semibold text-slate-400 hidden lg:block tracking-widest uppercase"
				>Julian Mican</span
			>
		</div>

		<!-- Desktop Menu -->
		<div class="hidden sm:flex items-center gap-1">
			{
				navigation.map((item) => (
					<a
						href={item.href}
						class={`px-4 py-2 text-sm font-medium transition-all duration-300 rounded-xl relative group
						${
							currentPath === item.href
								? "text-white bg-white/10"
								: "text-slate-400 hover:text-white hover:bg-white/5"
						}`}
					>
						{item.name}
						{currentPath === item.href && (
							<span class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-violet-400 rounded-full blur-[1px]" />
						)}
					</a>
				))
			}
		</div>

		<!-- Mobile Menu Button -->
		<div class="sm:hidden flex items-center">
			<button
				type="button"
				id="button-mobile-toggle"
				class="relative p-2 text-slate-400 hover:text-white transition-colors focus:outline-none"
			>
				<Bars3Icon id="bars-icon" class="block h-6 w-6" />
				<XMarkIcon id="x-icon" class="hidden h-6 w-6" />
			</button>
		</div>
	</nav>

	<!-- Mobile dropdown -->
	<div
		id="mobile-menu"
		class="fixed inset-x-4 top-24 glass-nav rounded-2xl border border-white/10 p-4 transition-all duration-300 opacity-0 scale-95 pointer-events-none sm:hidden shadow-2xl"
	>
		<div class="flex flex-col gap-2">
			{
				navigation.map((item) => (
					<a
						href={item.href}
						class={`px-4 py-3 rounded-xl transition-all ${currentPath === item.href ? "bg-white/10 text-white" : "text-slate-400 hover:bg-white/5 hover:text-white"}`}
					>
						{item.name}
					</a>
				))
			}
		</div>
	</div>
</header>

<script>
	const toggleBtn = document.getElementById("button-mobile-toggle");
	const barsIcon = document.getElementById("bars-icon");
	const xIcon = document.getElementById("x-icon");
	const mobileMenu = document.getElementById("mobile-menu");

	if (toggleBtn && mobileMenu && barsIcon && xIcon) {
		let isMenuOpen = false;

		toggleBtn.addEventListener("click", () => {
			isMenuOpen = !isMenuOpen;

			if (isMenuOpen) {
				mobileMenu.classList.remove(
					"opacity-0",
					"scale-95",
					"pointer-events-none",
				);
				mobileMenu.classList.add(
					"opacity-100",
					"scale-100",
					"pointer-events-auto",
				);
				barsIcon.classList.add("hidden");
				xIcon.classList.remove("hidden");
			} else {
				mobileMenu.classList.add(
					"opacity-0",
					"scale-95",
					"pointer-events-none",
				);
				mobileMenu.classList.remove(
					"opacity-100",
					"scale-100",
					"pointer-events-auto",
				);
				barsIcon.classList.remove("hidden");
				xIcon.classList.add("hidden");
			}
		});

		// Close menu on click outside
		document.addEventListener("click", (e) => {
			if (
				isMenuOpen &&
				!toggleBtn.contains(e.target as Node) &&
				!mobileMenu.contains(e.target as Node)
			) {
				isMenuOpen = false;
				mobileMenu.classList.add(
					"opacity-0",
					"scale-95",
					"pointer-events-none",
				);
				mobileMenu.classList.remove(
					"opacity-100",
					"scale-100",
					"pointer-events-auto",
				);
				barsIcon.classList.remove("hidden");
				xIcon.classList.add("hidden");
			}
		});
	}
</script>
